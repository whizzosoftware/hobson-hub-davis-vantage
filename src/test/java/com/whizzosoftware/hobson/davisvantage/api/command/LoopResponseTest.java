package com.whizzosoftware.hobson.davisvantage.api.command;

import org.junit.Test;

import java.text.ParseException;

import static org.junit.Assert.*;

public class LoopResponseTest {
    @Test
    public void testGoodLoopPacket() throws Exception {
        byte[] data = new byte[] {
                0x4c,0x4f,0x4f,0x00,0x00,(byte)0xbf,0x02,(byte)0xe7,0x74,(byte)0xef,0x02,0x1f,0x04,0x03,
                0x01,0x01,0x1d,0x01,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,
                (byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,
                (byte)0xff,0x20,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,
                (byte)0xff,0x00,0x00,(byte)0xff,(byte)0xff,0x7f,0x00,0x00,(byte)0xff,(byte)0xff,0x00,0x00,
                0x71,0x00,(byte)0x96,0x08,0x00,0x00,0x00,0x00,0x00,0x00,(byte)0xff,(byte)0xff,(byte)0xff,
                (byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x03,0x06,0x2d,0x71,0x02,(byte)0x8f,0x07,
                0x0a,0x0d,0x6e,(byte)0xa2
        };
        LoopResponse lr = new LoopResponse(data);
        assertEquals(0, (int)lr.getBarTrend());
        assertEquals(29927, (int)lr.getBarometer());
        assertEquals(751, (int)lr.getInsideTemp());
        assertEquals(31, (int)lr.getInsideHumidity());
        assertEquals(772, (int)lr.getOutsideTemp());
        assertEquals(32, (int)lr.getOutsideHumidity());
    }

    @Test
    public void testShortLoopPacket() throws Exception {
        byte[] data = new byte[] {
                0x4c,0x4f,0x4f,0x00,0x00,(byte)0xbf,0x02,(byte)0xe7,0x74,(byte)0xef,0x02,0x1f,0x04,0x03,
                0x01,0x01,0x1d,0x01,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,
                (byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,
                (byte)0xff,0x20,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,
                (byte)0xff,0x00,0x00,(byte)0xff,(byte)0xff,0x7f,0x00,0x00,(byte)0xff,(byte)0xff,0x00,0x00,
                0x71,0x00,(byte)0x96,0x08,0x00,0x00,0x00,0x00,0x00,0x00,(byte)0xff,(byte)0xff,(byte)0xff,
                (byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        };
        try {
            new LoopResponse(data);
            fail("Should have thrown exception");
        } catch (ParseException ignored) {}
    }
}
